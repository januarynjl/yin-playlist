<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>懒銀歌单</title>
    <link rel="shortcut icon" href="favicon.ico">
    <!-- 引入 layui.css -->
    <link href="https://unpkg.com/layui@2.11.4/dist/css/layui.css" rel="stylesheet">
    <style type="text/css">
        /* 全局样式 */
        body {
            background-color: #f8f9fa;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        
        /* 字体优化 */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
            margin-bottom: 10px;
        }
        
        h1 {
            font-size: 28px;
        }
        
        h2 {
            font-size: 24px;
        }
        
        h3 {
            font-size: 18px;
        }
        
        h4 {
            font-size: 16px;
        }
        
        p {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        /* 表格字体 */
        .layui-table {
            font-size: 14px;
            line-height: 1.5;
        }
        
        .layui-table th {
            font-size: 14px;
            font-weight: 600;
        }
        
        .layui-table td {
            font-size: 13px;
        }
        
        /* 按钮字体 */
        .layui-btn {
            font-size: 14px;
            font-weight: 500;
        }
        
        /* 输入框字体 */
        .layui-input, .layui-textarea, .layui-select {
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* 表单标签字体 */
        .layui-form-label {
            font-size: 14px;
            font-weight: 500;
        }
        
        /* 卡片标题字体 */
        .layui-card-header {
            font-size: 16px;
            font-weight: 600;
        }
        
        /* 响应式字体调整 */
        @media screen and (max-width: 768px) {
            body {
                font-size: 13px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            h2 {
                font-size: 20px;
            }
            
            h3 {
                font-size: 16px;
            }
            
            .layui-table {
                font-size: 13px;
            }
            
            .layui-table th {
                font-size: 13px;
            }
            
            .layui-table td {
                font-size: 12px;
            }
            
            .layui-btn {
                font-size: 13px;
            }
            
            .layui-input, .layui-textarea, .layui-select {
                font-size: 13px;
            }
            
            .layui-card-header {
                font-size: 14px;
            }
        }
        
        @media screen and (max-width: 480px) {
            body {
                font-size: 12px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            h2 {
                font-size: 18px;
            }
            
            h3 {
                font-size: 14px;
            }
            
            .layui-table {
                font-size: 12px;
            }
            
            .layui-table th {
                font-size: 12px;
            }
            
            .layui-table td {
                font-size: 11px;
            }
            
            .layui-btn {
                font-size: 12px;
            }
            
            .layui-input, .layui-textarea, .layui-select {
                font-size: 12px;
            }
        }
        
        /* 修复栏样式 */
        .layui-fixbar li{
            border-radius: 50px;
            transition: all 0.3s ease;
        }
        
        .layui-fixbar li:hover {
            transform: scale(1.1);
        }
        
        /* 主色调设置 */
        :root {
            --primary-color: #ff98a0;
            --secondary-color: #fd4c5b;
            --accent-color: #23ade5;
            --background-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e9ecef;
            --success-color: #52c41a;
            --warning-color: #faad14;
        }
        
        /* 搜索按钮样式 */
        .search-btn{
            background-color: var(--primary-color);
            transition: all 0.3s ease;
            border-radius: 8px;
            padding: 0 16px !important;
            font-weight: 500;
        }
        
        .search-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 152, 160, 0.3);
        }
        
        .search-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(255, 152, 160, 0.3);
        }
        
        /* 输入框样式 */
        .layui-input, .layui-textarea, .layui-select {
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            padding: 0 12px;
            height: 42px;
            font-size: 14px;
        }
        
        .layui-input:focus, .layui-textarea:focus {
            border-color: var(--primary-color) !important;
            box-shadow: 0 0 0 2px rgba(255, 152, 160, 0.2) !important;
            outline: none;
        }
        
        .layui-input:hover, .layui-textarea:hover, .layui-select:hover {
            border-color: var(--primary-color);
        }
        
        /* 下拉选择样式 */
        .layui-form-select {
            border-radius: 8px;
        }
        
        .layui-form-select dl {
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .layui-form-select dl dd {
            transition: all 0.2s ease;
            padding: 8px 16px;
        }
        
        .layui-form-select dl dd:hover {
            background-color: #f8f9fa;
            color: var(--primary-color);
        }
        
        .layui-form-select dl dd.layui-this {
            color: var(--primary-color) !important;
            background-color: rgba(255, 152, 160, 0.1) !important;
        }
        
        .layui-form-select .layui-edge {
            transition: all 0.3s ease;
        }
        
        .layui-form-select:hover .layui-edge {
            color: var(--primary-color);
        }
        
        /* 按钮样式 */
        .layui-btn {
            padding: 0 16px !important;
            transition: all 0.3s ease;
            border-radius: 8px;
            font-weight: 500;
            height: 42px;
            line-height: 42px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .layui-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .layui-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        .layui-btn-primary {
            border: 1px solid var(--border-color);
            background-color: #fff;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .layui-btn-primary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(255, 152, 160, 0.05);
        }
        
        /* 日期选择器样式 */
        .laydate-day-holidays::before {
            content: "A";
            color: var(--secondary-color);
            left: 2px;
            transform: scale(.8);
        }
        
        .laydate-B::after {
            content: "B";
            background-color: transparent;
            color: var(--accent-color);
            position: absolute;
            top: 0;
            right: 2px;
            font-size: 12px;
            transform: scale(.8);
        }
        
        /* 计数样式 */
        .count{
            color: var(--primary-color);
            font-weight: bold;
        }
        
        /* 按钮容器 */
        .layui-btn-container {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .layui-btn-container .layui-btn {
            margin: 0;
        }
        
        /* 录播链接按钮 */
        .broadcost_A{
            margin-right: 6px;
            background-color: var(--secondary-color);
            transition: all 0.3s ease;
            border-radius: 4px;
            padding: 0 8px !important;
            font-size: 11px;
            height: 24px !important;
            line-height: 24px !important;
        }
        
        .broadcost_B{
            background-color: var(--accent-color);
            transition: all 0.3s ease;
            border-radius: 4px;
            padding: 0 8px !important;
            font-size: 11px;
            height: 24px !important;
            line-height: 24px !important;
        }
        
        .broadcost_A:hover, .broadcost_B:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* 表单样式 */
       
        
        .layui-input-wrap {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }
        
        /* 表单标签 */
        .layui-form-label {
            color: var(--text-primary);
            font-weight: 500;
            padding: 9px 15px;
        }
        
        /* 表单验证样式 */
        .layui-form-item .layui-form-error {
            color: var(--secondary-color);
            font-size: 12px;
            margin-top: 4px;
        }
        
        /* 清除按钮样式 */
        .layui-input-affix .layui-input-clear {
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }
        
        .layui-input-affix .layui-input-clear:hover {
            color: var(--secondary-color);
            transform: scale(1.1);
        }
        
        /* 卡片样式 */
        .layui-card {
            border-radius: 12px;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.05);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .layui-card:hover {
            box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.1);
        }
        
        /* 卡片头部 */
        .layui-card-header {
            background-color: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* 卡片内容 */
        .layui-card-body {
            padding: 20px;
            background-color: var(--card-bg);
        }
        
        /* 表格样式 */
        .layui-table {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .layui-table:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .layui-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--text-primary);
            padding: 14px 12px;
            border-bottom: 2px solid var(--primary-color);
            text-align: left;
            transition: all 0.2s ease;
        }
        
        .layui-table th:hover {
            background-color: #f1f3f5;
        }
        
        .layui-table td {
            padding: 14px 12px;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            border-bottom: 1px solid var(--border-color);
        }
        
        .layui-table tr {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .layui-table tr:hover {
            background-color: #f8f9fa !important;
            transform: translateY(-1px);
            border-left: 3px solid var(--primary-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .layui-table tr:hover td {
            color: var(--text-primary);
        }
        
        /* 表格中的热门和新歌图标 */
        .layui-table img {
            margin-left: 8px;
            vertical-align: middle;
            transition: all 0.3s ease;
        }
        
        .layui-table tr:hover img {
            transform: scale(1.1);
        }
        
        /* 表格排序样式 */
        .layui-table th .layui-table-sort {
            color: var(--text-secondary);
        }
        
        .layui-table th .layui-table-sort:hover {
            color: var(--primary-color);
        }
        
        /* 表格空数据提示 */
        .layui-table-tips-main {
            padding: 40px 0;
            color: var(--text-secondary);
            text-align: center;
        }
        
        /* 排行榜表格特殊样式 */
        #rank-table {
            border-radius: 8px;
            overflow: hidden;
        }
        
        #rank-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        /* 排行榜前三名样式 */
        #rank-table tr:nth-child(1) {
            background-color: rgba(255, 215, 0, 0.1) !important;
            position: relative;
        }
        
        #rank-table tr:nth-child(1)::before {
            content: "1";
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 30px;
            background-color: #FFD700;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        #rank-table tr:nth-child(2) {
            background-color: rgba(192, 192, 192, 0.1) !important;
            position: relative;
        }
        
        #rank-table tr:nth-child(2)::before {
            content: "2";
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 30px;
            background-color: #C0C0C0;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        #rank-table tr:nth-child(3) {
            background-color: rgba(205, 127, 50, 0.1) !important;
            position: relative;
        }
        
        #rank-table tr:nth-child(3)::before {
            content: "3";
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 30px;
            background-color: #CD7F32;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        /* 调整排行榜表格内容缩进 */
        #rank-table tr td:first-child {
            padding-left: 40px !important;
        }
        
        /* 热门歌曲图标增强 */
        .layui-table img.hot-icon {
            animation: pulse 2s infinite;
        }
        
        /* 表单样式 */
       
        
        .layui-input-wrap {
            position: relative;
        }
        
        /* 响应式调整 */
        @media screen and (max-width: 1200px) {
            .layui-col-md3 {
                flex: 0 0 50%;
                max-width: 50%;
            }
        }
        
        @media screen and (max-width: 768px) {
            .layui-fluid {
                padding: 10px !important;
            }
            
            .page-header {
                margin-bottom: 20px;
            }
            
            .page-header h1 {
                font-size: 24px;
            }
            
            .page-header p {
                font-size: 14px;
            }
            
            .layui-card {
                border-radius: 8px;
            }
            
            .layui-card-header {
                padding: 12px;
                font-size: 14px;
            }
            
            .layui-card-body {
                padding: 12px;
            }
            
            .layui-col-md3 {
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .layui-input, .layui-select {
                height: 38px;
                font-size: 13px;
            }
            
            /* 手机布局下的下拉框样式 */
            .layui-form-select dl {
                max-height: 400px !important;
                min-width: 100% !important;
                width: 100% !important;
            }
            
            /* 手机布局下的下拉框选项样式 */
            .layui-form-select dl dd {
                padding: 14px 20px !important;
                font-size: 14px !important;
            }
            
            .layui-btn {
                padding: 0 12px !important;
                height: 38px;
                line-height: 38px;
                font-size: 13px;
            }
            
            .layui-btn-container {
                flex-direction: column;
                gap: 8px;
            }
            
            .layui-btn-container .layui-btn {
                width: 100%;
                margin: 0;
            }
            
            .layui-table {
                font-size: 13px;
            }
            
            .layui-table th,
            .layui-table td {
                padding: 10px 8px;
            }
            
            #rank-page {
                min-width: unset !important;
                width: 100% !important;
            }
            
            #rank-page > div {
                padding: 12px !important;
                min-width: unset !important;
            }
            
            .layui-fixbar {
                right: 10px !important;
                bottom: 20px !important;
            }
        }
        
        @media screen and (max-width: 480px) {
            .page-header h1 {
                font-size: 20px;
            }
            
            .layui-card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .layui-table {
                font-size: 12px;
            }
            
            .layui-table th,
            .layui-table td {
                padding: 8px 6px;
            }
            
            .layui-btn {
                font-size: 12px;
                gap: 4px;
            }
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
        
        /* 页面元素动画 */
        .layui-card {
            animation: fadeIn 0.5s ease-out;
        }
        
        .page-header {
            animation: slideIn 0.5s ease-out;
        }
        
        .layui-form {
            animation: fadeIn 0.6s ease-out 0.1s both;
        }
        
        .layui-table {
            animation: fadeIn 0.7s ease-out 0.2s both;
        }
        
        /* 加载动画 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }
        
        .loading-large {
            width: 40px;
            height: 40px;
            border-width: 3px;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        /* 加载遮罩 */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeIn 0.3s ease-out;
        }
        
        /* 弹窗动画 */
        .layui-layer {
            animation: fadeIn 0.3s ease-out;
        }
        
        .layui-layer-content {
            animation: slideIn 0.3s ease-out;
        }
        
        /* 按钮点击动画 */
        .layui-btn:active {
            animation: pulse 0.2s ease-in-out;
        }
        
        /* 表格数据加载动画 */
        .layui-table-loading {
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        .layui-table-loading td {
            padding: 40px 0;
        }
        
        /* 元素悬停动画 */
        .layui-table tr {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .layui-btn {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .layui-card {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* 滚动动画 */
        @keyframes scrollIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .scroll-in {
            animation: scrollIn 0.6s ease-out;
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        
        /* 调整 laydate 组件按钮大小，防止超出边框 */
        .layui-laydate-footer {
            padding: 10px 15px !important;
        }
        
        .layui-laydate-footer .layui-laydate-btns {
            display: flex !important;
            gap: 8px !important;
            justify-content: flex-end !important;
        }
        
        .layui-laydate-footer .layui-laydate-btns span {
            padding: 0 10px !important;
            height: 28px !important;
            line-height: 28px !important;
            font-size: 12px !important;
            border-radius: 4px !important;
        }
        
        /* 确保按钮不会超出容器 */
        .layui-laydate {
            overflow: hidden !important;
        }
        
        /* 强制修复下拉框样式 - 确保下拉框能够正常选中 */
        /* 确保表单容器不会影响下拉框 */
        .layui-card-body {
            position: relative !important;
            z-index: 1 !important;
        }
        
        .layui-form {
            position: relative !important;
            z-index: 1 !important;
        }
        
        /* 下拉框相关元素的层级 */
        .layui-form-item {
            position: relative !important;
            z-index: 999999 !important;
        }
        
        .layui-input-block {
            position: relative !important;
            z-index: 999999 !important;
        }
        
        /* 下拉框样式优化 */
        .layui-form-select {
            position: relative !important;
            z-index: 999999 !important;
            overflow: visible !important;
            transition: all 0.3s ease !important;
            width: 100% !important;
        }
        
        /* 确保下拉框所在容器宽度与其他搜索框一致 */
        .layui-form-item {
            margin: 0 !important;
            width: 100% !important;
        }
        
        .layui-input-block {
            margin: 0 !important;
            width: 100% !important;
        }
        
        /* 确保select元素宽度与其他输入框一致 */
        .layui-form-select select {
            width: 100% !important;
            border-radius: 8px !important;
            height: 42px !important;
            padding: 0 12px !important;
            font-size: 14px !important;
        }
        
        /* 确保下拉菜单宽度与输入框一致 */
        .layui-form-select dl {
            min-width: 100% !important;
            width: 100% !important;
        }
        
        /* 下拉框箭头样式 */
        .layui-form-select .layui-edge {
            transition: all 0.3s ease !important;
            color: var(--text-secondary) !important;
        }
        
        .layui-form-select:hover .layui-edge {
            color: var(--primary-color) !important;
            transform: rotate(180deg) !important;
        }
        
        /* 当下拉框打开时的样式 */
        .layui-form-select.layui-form-selected {
            border-color: var(--primary-color) !important;
        }
        
        .layui-form-select.layui-form-selected .layui-edge {
            color: var(--primary-color) !important;
            transform: rotate(180deg) !important;
        }
        
        /* 下拉菜单样式 */
        .layui-form-select dl {
            max-height: 300px !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            position: absolute !important;
            z-index: 999999 !important;
            top: 100% !important;
            left: 0 !important;
            margin-top: 5px !important;
            box-shadow: 0 6px 20px 0 rgba(255, 152, 160, 0.2) !important;
            border: 1px solid rgba(255, 152, 160, 0.3) !important;
            background-color: white !important;
            border-radius: 8px !important;
            animation: dropdownFadeIn 0.3s ease-out !important;
            min-width: 100% !important;
            width: 100% !important;
        }
        
        /* 确保选项内容不会导致水平滚动 */
        .layui-form-select dl dd {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
        }
        
        /* 下拉菜单动画 */
        @keyframes dropdownFadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* 下拉框选项样式 */
        .layui-form-select dl dd {
            padding: 12px 20px !important;
            cursor: pointer !important;
            position: relative !important;
            z-index: 999999 !important;
            background-color: white !important;
            border-bottom: 1px solid #f8f9fa !important;
            transition: all 0.3s ease !important;
            border-radius: 0 !important;
        }
        
        /* 选项悬停效果 */
        .layui-form-select dl dd:hover {
            background-color: rgba(255, 152, 160, 0.1) !important;
            color: var(--primary-color) !important;
            transform: translateX(5px) !important;
        }
        
        /* 选中选项样式 */
        .layui-form-select dl dd.layui-this {
            background-color: var(--primary-color) !important;
            color: white !important;
            font-weight: 500 !important;
        }
        
        /* 选项分隔线 */
        .layui-form-select dl dd:last-child {
            border-bottom: none !important;
        }
        
        /* 下拉菜单滚动条样式 */
        .layui-form-select dl::-webkit-scrollbar {
            width: 6px !important;
        }
        
        .layui-form-select dl::-webkit-scrollbar-track {
            background: #f1f1f1 !important;
            border-radius: 3px !important;
        }
        
        .layui-form-select dl::-webkit-scrollbar-thumb {
            background: rgba(255, 152, 160, 0.5) !important;
            border-radius: 3px !important;
        }
        
        .layui-form-select dl::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color) !important;
        }
        
        /* 确保表格及其所有子元素的 z-index 低于下拉框 */
        .layui-table {
            position: relative !important;
            z-index: 1 !important;
        }
        
        .layui-table thead {
            position: relative !important;
            z-index: 1 !important;
        }
        
        .layui-table th {
            position: relative !important;
            z-index: 1 !important;
        }
        
        .layui-table tbody {
            position: relative !important;
            z-index: 1 !important;
        }
        
        .layui-table tr {
            position: relative !important;
            z-index: 1 !important;
        }
        
        .layui-table td {
            position: relative !important;
            z-index: 1 !important;
        }
    </style>
</head>
<body>
<!-- HTML Content -->
<div class="layui-fluid" style="padding: 20px;">
    <!-- 页面标题区域 -->
    <div class="page-header" style="text-align: center; position: relative;">
        <div style="display: inline-block; position: relative;">
            <h1 style="color: var(--text-primary);  font-size: 28px; font-weight: 700; position: relative; display: inline-block;">
                <i class="layui-icon layui-icon-music" style="color: var(--primary-color); margin-right: 10px; font-size: 32px;"></i>
                懒銀歌单
            </h1>
        </div>
        <p style="color: var(--text-secondary); font-size: 16px; ">
            <i class="layui-icon layui-icon-date" style="color: var(--accent-color); margin-right: 5px;"></i>
            2026直播天数【<span class="count" id="dateCount">0</span>】
        </p>
        <div style="width: 100px; height: 4px; background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)); border-radius: 2px; margin: 15px auto 0;"></div>
    </div>
    
    <div class="layui-card">
        <div class="layui-card-header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: var(--text-primary);">
                    歌曲列表
                </h3>
                <span style="color: var(--primary-color); font-weight: bold;">
                    共 <span class="count" id="count">0</span> 首歌曲
                </span>
            </div>
        </div>
        <!-- 搜索表单 - 移到卡片外部，确保下拉框不受表格影响 -->
        <div style="position: relative; z-index: 10000; padding: 15px 20px; background-color: white; border-bottom: 1px solid #e6e6e6;">
            <form class="layui-form layui-row layui-col-space16"  lay-filter="search-filter">
                <div class="layui-col-md3">
                    <div class="layui-input-wrap" style="border-radius: 8px; overflow: hidden;">
                        <input type="text" name="sName" value="" placeholder="歌名" class="layui-input" lay-affix="clear" style="border-radius: 8px;">
                    </div>
                </div>
                <div class="layui-col-md3">
                    <div class="layui-input-wrap" style="border-radius: 8px; overflow: hidden;">
                        <input type="text" name="sSinger" placeholder="歌手" lay-affix="clear" class="layui-input" style="border-radius: 8px;">
                    </div>
                </div>
                <div class="layui-col-md3">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <select name="sSign" lay-verify="required">
                                <option value="">风格</option>
                                <option value="悲伤情歌">悲伤情歌</option>
                                <option value="古风国风">古风国风</option>
                                <option value="活泼可爱">活泼可爱</option>
                                <option value="温柔治愈">温柔治愈</option>
                                <option value="民谣乐队杂食">民谣乐队杂食</option>
                                <option value="外语杂食">外语杂食</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md3">
                    <div class="layui-input-wrap" style="border-radius: 8px; overflow: hidden;">
                        <input type="text" name="sPre" placeholder="首字母/语种" lay-affix="clear" class="layui-input" style="border-radius: 8px;">
                    </div>
                </div>
                <div class="layui-btn-container layui-col-xs12" style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;">
                    <button class="layui-btn search-btn" lay-submit lay-filter="playlist-search" id="btn-submit">
                        <i class="layui-icon layui-icon-search" style="margin-right: 5px;"></i>搜索
                    </button>
                    <button type="reset" class="layui-btn layui-btn-primary"  id="btn-clear">
                        <i class="layui-icon layui-icon-refresh" style="margin-right: 5px;"></i>清除
                    </button>
                    <button type="button" class="layui-btn layui-btn-primary" lay-on="test-page-wrap">
                        <i class="layui-icon layui-icon-fire" style="margin-right: 5px;"></i>热门歌曲
                    </button>
                    <button type="button" class="layui-btn layui-btn-primary" id="live-date">
                        <i class="layui-icon layui-icon-date" style="margin-right: 5px;"></i>直播日历
                    </button>
                    <input type="hidden" id="live-date-val">
                </div>
            </form>
        </div>
        
        <!-- 歌曲表格 -->
        <div class="layui-card-body" style="padding: 15px 20px;">
            <table class="layui-table" id="playList-table"></table>
        </div>
    </div>

</div>
<div id="rank-page" style="display: none;">
    <div style="padding: 20px; min-width: 600px;">
        <table class="" id="rank-table"></table>
    </div>
</div>
<!-- 引入 layui.js -->
<script src="https://unpkg.com/layui@2.11.4/dist/layui.js"></script>
<script>
    var playList_origin;
    layui.define(['jquery'], function(exports){
        var $ = layui.jquery;

        var fetchData = function(url, callback) {
            $.getJSON(url, function(data) {
                callback(data);
            });
        };

        exports('dataModule', {fetchData: fetchData}); // 导出模块功能
    });


    // Usage
    layui.use(function(){
        var $ = layui.$;
        var form = layui.form;
        var table = layui.table;
        var dataModule = layui.dataModule;
        var util = layui.util;
        var laydate = layui.laydate;
        
        // 渲染表单元素
        form.render();

        var broadcastMap = new Map();
        var liveDateList_A;
        var liveDateList_B;
        var liveDateList;
        
        // 加载所有数据后再初始化日期控件
        function initDateControl() {
            if (broadcastMap.size > 0 && liveDateList_A && liveDateList_B && liveDateList) {
                // 渲染
                laydate.render({
                    eventElem: '#live-date',
                    trigger: 'click',
                    elem: '#live-date-val',
                    value: new Date(new Date().setDate(new Date().getDate() - 1)),
                    id:'live-date',
                    //holidays:[data,[]],
                    showBottom: true,
                    autoConfirm : false,
                    btns: [],
                    theme: ['#ff98a0','grid'],
                    disabledDate: function(date, type){
                        return date.getTime() > Date.now();
                    },

                    change: function(value, date) {
                        this.cellRender(date);
                        $("#live-date").text("直播日历");
                    },
                    ready: function (date) {
                    var that = this;
                    
                    // 延迟获取面板元素，确保DOM已完全渲染
                    setTimeout(function() {
                        // 直接获取最新打开的laydate面板
                        var panelEl = $('.layui-laydate:last');
                        
                        // 确保预览元素存在，如果不存在则创建
                        that._previewEl = panelEl.find('.layui-laydate-preview');
                        if (!that._previewEl.length) {
                            // 创建预览元素
                            that._previewEl = $('<div class="layui-laydate-preview" style="padding: 10px; border-top: 1px solid #e6e6e6;"></div>');
                            panelEl.find('.layui-laydate-main').after(that._previewEl);
                        }
                        
                        // 手动构建当前日期对象，确保格式正确
                        var today = new Date(new Date().setDate(new Date().getDate() - 1));
                        var currentDate = {
                            year: today.getFullYear(),
                            month: today.getMonth() + 1,
                            date: today.getDate()
                        };
                        
                        // 直接渲染录播链接，不依赖 cellRender
                        var y = currentDate.year;
                        var m = currentDate.month;
                        var d = currentDate.date;
                        var dateStr = layui.util.toDateString(new Date(y, m-1, d), 'yyyy-MM-dd');
                        
                        if (broadcastMap.has(dateStr)) {
                            let broadcastList = broadcastMap.get(dateStr);
                            let text = '';
                            for (let i = 0; i < broadcastList.length; i++) {
                                text += '<a class="broadcost_'+broadcastList[i].pt+' layui-btn layui-btn-xs layui-btn-normal" target="_blank" href="'+broadcastList[i].url+'">'+broadcastList[i].pt+'录播链接' + '</a>';
                            }
                            var tipsText = [
                                '<div class="preview-inner">',
                                text,
                                '</div>'
                            ].join('');
                            that._previewEl.html(tipsText);
                        } else {
                            var tipsText = [
                                '<div class="preview-inner">',
                                '<div style="color:#333;">暂无录播</div>',
                                '</div>'
                            ].join('');
                            that._previewEl.html(tipsText);
                        }
                        
                        // 设置输入框值
                        that.elem.val(dateStr);
                    }, 100);
                },
                    cellRender: function (ymd, render, info) {
                        var that = this;
                        var y = ymd.year;
                        var m = ymd.month;
                        var d = ymd.date;
                        var date = layui.util.toDateString(new Date(y, m-1, d), 'yyyy-MM-dd');
                        if (that._previewEl && (!info || (info && info.type === "date"))) {

                            if(broadcastMap.has(date)){
                                let broadcastList = broadcastMap.get(date);
                                let text = '';
                                for (let i = 0; i < broadcastList.length; i++) {
                                    text += '<a class="broadcost_'+broadcastList[i].pt+' layui-btn layui-btn-xs layui-btn-normal" target="_blank" href="'+broadcastList[i].url+'">'+broadcastList[i].pt+'录播链接' + '</a>';
                                }
                                var tipsText = [
                                    '<div class="preview-inner">',
                                    text,
                                    '</div>'
                                ].join('');
                                that._previewEl.html(tipsText);
                            }else{
                                var tipsText = [
                                    '<div class="preview-inner">',
                                    '<div style="color:#333;">暂无录播</div>',
                                    '</div>'
                                ].join('');
                                that._previewEl.html(tipsText);
                            }
                        }
                        if (!render) return;

                        var is_A = liveDateList_A.includes(date);
                        var is_B = liveDateList_B.includes(date);
                        if (info.type == 'date') {
                            var clazz = [
                                'date-cell-inner',
                                is_A ? 'laydate-day-holidays' : '',
                                is_B ? 'laydate-B' : '',
                            ].join(' ');
                            var content = [
                                '<div class="' + clazz + '">',
                                '<b>' + d + '</b>',
                                '</div>',
                            ].join('');
                            // render(content)
                            // render($(content)[0])
                            var contentEl = $(content);
                            render(contentEl);
                        }
                    }
                });
            }
        }
        
        // 加载 broadcastMap
        dataModule.fetchData('./data/broadcastMap.json', function(data) {
            Object.entries(data).forEach(([key, value]) => {
                broadcastMap.set(key, value);
            });
            initDateControl();
        });
        
        // 加载 liveDateList_A
        dataModule.fetchData('./data/liveDateList_A.json', function(data) {
            liveDateList_A = data;
            initDateControl();
        });
        
        // 加载 liveDateList_B
        dataModule.fetchData('./data/liveDateList_B.json', function(data) {
            liveDateList_B = data;
            initDateControl();
        });
        
        // 加载 liveDateList_2026
        dataModule.fetchData('./data/liveDateList_2026.json', function(data) {
            $("#dateCount").text(data.length);
        });
        
        // 加载 liveDateList
        dataModule.fetchData('./data/liveDateList.json', function(data) {
            liveDateList = data;
            initDateControl();
        });

        util.fixbar({
            top: true //返回顶部
            , css: { right: 15, bottom: 35,'border-radius': '50px' }
            , bgcolor: '#ff98a0'
            , click: function (type) {

            }
        });
        util.on('lay-on', {
            'test-page-wrap': function () {
                layer.open({
                    type: 1,
                    title: "热门歌曲 统计时间：01-29 24:00",
                    shade: 0.3, // 不显示遮罩
                    content: $('#rank-page'), // 捕获的元素
                    end: function () {
                        // layer.msg('关闭后的回调', {icon:6});
                    }
                });
            }
        });
        dataModule.fetchData('./data/playList.json', function(data) {
            playList_origin = data;
            $("#count").text(data.length);
            playList = playList_origin;
            // 创建表格实例
            table.render({
                elem: '#playList-table',
                size:'lg',
                data: playList,
                cols: [[
                    {type: 'numbers', title: '序号',width:60},
                    {field:'sName', title: '歌名',maxWidth:300,minWidth:150, templet: function(d) {
                            return d.sName+ (d.isHot > 0  ? '<img src="img/hot.gif" >' : '')+ (d.isNew> 0  ? '<img src="img/new.gif" >' : '');
                        }},
                    {field:'sSinger', title: '歌手', width:150},
                    {field:'sSign', title: '风格', width:120},
                    {field:'sumCount', title: '点歌次数', width:90},
                    {field:'sPre', title: '首字母/语种', width:110}/*,
                    {field:'sUpDown', title: '升降调',  width:80}*/
                ]],

                //skin: 'line', // 表格风格
                even: true,
                page: false, // 是否显示分页
                limits: [10, 20, 50],
                limit: 20 // 每页默认显示的数量
            });

            var rankList = playList_origin.filter(song => song.isHot>0);
            rankList.sort(function (a,b) {

                return b.sumCount - a.sumCount == 0
                    ? (b.updateTime-a.updateTime ):(b.sumCount - a.sumCount);
            });

            // 点歌次数
            table.render({
                elem: '#rank-table',
                size:'lg',
                data: rankList,
                cols: [[
                    {field:'sName', title: '歌名',width:140},
                    {field:'sumCount', title: '点歌次数', width:90},
                    {field:'aCount', title: 'A', width:60, sort: true},
                    {field:'bCount', title: 'B', width:60, sort: true},
                    {field:'sSinger', title: '歌手', width:150},
                    {field:'sSign', title: '风格', width:120}
                ]],

                //skin: 'line', // 表格风格
                even: true,
                page: false, // 是否显示分页
            });
        });
        $('#btn-submit').on('click', function(){
            form.submit('search-filter', function(data){
                var field = data.field; // 获取表单全部字段值
                console.log(field);// 回调函数返回的 data 参数和提交事件中返回的一致
                search(field);

            });
            return false;
        });
        $('#btn-clear').on('click', function(){
            search({sName: '', sSinger: '', sSign: '', sPre: ''})
        });


        function search(field){
            let filter_list = []
            let cdata = playList_origin;
            if(field.sName == "" && field.sSinger == "" && field.sSign == ""  && field.sPre == ""){
                filter_list = cdata;
            }else if(field.sPre =="open"){
                table.reload('playList-table', {
                    cols: [[
                        {type: 'numbers', title: '序号',width:60},
                        {field:'sName', title: '歌名',maxWidth:300,minWidth:150},
                        {field:'sSinger', title: '歌手', width:150},
                        {field:'sSign', title: '风格', width:120},
                        {field:'sumCount', title: '点歌次数', width:90},
                        {field:'sPre', title: '首字母/语种', width:110},
                        {field:'sUpDown', title: '升降调',  width:80}
                    ]],
                });
            }else{
                $.each(cdata, function (i, row) {
                    var isSearchInRow_sName = false
                    var isSearchInRow_sSinger = false;
                    var isSearchInRow_sSign = false;
                    var isSearchInRow_sPre = false;
                    if(field.sName != "" && row.sName.toUpperCase().indexOf(field.sName.toUpperCase())> -1){
                        isSearchInRow_sName = true;
                    }else{
                        if(field.sName == ""){
                            isSearchInRow_sName = true;
                        }
                    }
                    if(field.sSinger != "" && row.sSinger.toUpperCase().indexOf(field.sSinger.toUpperCase())> -1){
                        isSearchInRow_sSinger = true;
                    }else{
                        if(field.sSinger == ""){
                            isSearchInRow_sSinger = true;
                        }
                    }
                    if(field.sSign != "" && row.sSign.indexOf(field.sSign)> -1){
                        isSearchInRow_sSign = true;
                    }else{
                        if(field.sSign == ""){
                            isSearchInRow_sSign = true;
                        }
                    }
                    if(field.sPre != "" && (row.sPre.indexOf(field.sPre)> -1 || row.sPre == field.sPre.toUpperCase())){
                        isSearchInRow_sPre = true;
                    }else{
                        if(field.sPre == ""){
                            isSearchInRow_sPre = true;
                        }
                    }
                    if (isSearchInRow_sName && isSearchInRow_sSinger && isSearchInRow_sSign && isSearchInRow_sPre) {
                        filter_list.push(row)

                    }
                });
            }
            // 执行搜索重载
            table.reload('playList-table', {
                data: filter_list,
            });
        }
    });

</script>
</body>
</html>